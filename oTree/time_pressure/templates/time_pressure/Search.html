{% extends "global/Page.html" %}
{% load staticfiles otree %}

{% block title %}
    Search Task
{% endblock %}

{% block content %}

    <p>Your task is to find relevant documents for the topic: {{ player.topic }}</p>

    <!--Search form-->
    <form>
        <input class="search" type="text" name="search" placeholder="Search..">
    </form>

    <!--Results-->
    <div class="results">
        Results...
    </div>

    <!--Logs-->
    <input type="hidden" name="total_task_time"
    value="300" id="total_task_time"/>

    {% next_button %}

{% endblock %}

{% block styles %}

    <!--CSS-->
    <style type="text/css">
        input[type=text] {
            width: 100%;
        }
    </style>

{% endblock %}

{% block scripts %}

    <!--Javascript-->
    <script>
        $(document).ready(function () {
           var t0 = new Date().getTime() / 1000;
           var t1 = 0;

            $(".otree-btn-next").click(function(){
                t1 = new Date().getTime() / 1000;
                t = t1-t0;
                $("#total_task_time").val(t);

            });
        });

        $(function(){
            $(".search").keyup(function() {
                var searchid = $(this).val();
                var dataString = {
                    "from" : 0,
                    "size" : 10,
                    "query": {
                        "query_string" : {
                            "fields" : ["headline", "body"],
                                "query" : "economy"
                        }
                    }
                };

                if(searchid!='') {
                    $.ajax({
                        type: "GET",
                        url: "http://23.251.143.109:9200/_search",
                        dataType: 'json',
                        contentType: 'application/json; charset=utf-8',
                        processData: false,
                        data: dataString,
                        success: function(data) {
                            console.log(data)
                        },
                        error: function(e) {
                          console.log(e);
                        }
                    });
                }return false;
                });
            });
    </script>

{% endblock %}
