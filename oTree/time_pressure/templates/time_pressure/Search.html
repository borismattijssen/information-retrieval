{% extends "global/Page.html" %}
{% load staticfiles otree %}

{% block title %}
    Search Task
{% endblock %}

{% block content %}

    <p>Your task is to find relevant documents for the topic: {{ player.topic }}</p>

    <!--Search form-->
    <form>
        <input class="search" type="text" name="search" placeholder="Search..">
    </form>

    <!--Results-->
    <div class="results">
        Results...
    </div>

    <!--Logs-->
    <input type="hidden" name="total_task_time"
    value="300" id="total_task_time"/>

    {% next_button %}

{% endblock %}

{% block styles %}

    <!--CSS-->
    <style type="text/css">
        input[type=text] {
            width: 100%;
        }
    </style>

{% endblock %}

{% block scripts %}

    <!--Javascript-->
    <script>
        $(document).ready(function () {
           var t0 = new Date().getTime() / 1000;
           var t1 = 0;

            $(".otree-btn-next").click(function(){
                t1 = new Date().getTime() / 1000;
                t = t1-t0;
                $("#total_task_time").val(t);

            });
        });

        $(function(){
            $(".search").keyup(function() {
                var searchid = $(this).val();
                var dataString = {
                    "from" : 0,
                    "size" : 10,
                    "query": {
                        "query_string" : {
                            "fields" : ["headline", "body"],
                                "query" : "economy"
                        }
                    }
                };

                if(searchid!='') {
                  var xhr = new XMLHttpRequest();
                  xhr.open('GET', 'http://35.190.214.52:9200/_search');
                  xhr.setRequestHeader('Content-Type', 'application/json');
                  xhr.onload = function() {
                      if (xhr.status === 200) {
                          var data = JSON.parse(xhr.responseText);
                          console.log(data);
                      } else {
                        console.log("Error", oXHR.statusText);
                      }
                  };
                  xhr.send(JSON.stringify(dataString));
                }return false;
                });
            });
    </script>

{% endblock %}
